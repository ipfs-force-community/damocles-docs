(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{401:function(t,s,a){"use strict";a.r(s);var e=a(17),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"configurations-of-damocles-worker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configurations-of-damocles-worker"}},[t._v("#")]),t._v(" Configurations of damocles-worker")]),t._v(" "),a("p",[t._v("damocles-worker is the main execution body of data sealing. Let's take a look at its configuration file structure and configuration options.")]),t._v(" "),a("p",[t._v("The configuration file of "),a("code",[t._v("damocles-worker")]),t._v(" is in "),a("code",[t._v("toml")]),t._v(" format. It should be noted that in this format, lines starting with "),a("code",[t._v("#")]),t._v(" will be regarded as comments and will not take effect.")]),t._v(" "),a("p",[t._v("Taking a mock instance as an example, a basic configuration might look like this:")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("worker")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# name = "worker-#1"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# rpc_server.host = "192.168.1.100"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rpc_server.port = 17891")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("metrics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#enable = false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#http_listen = "0.0.0.0:9000"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sector_manager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("rpc_client.addr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/127.0.0.1/tcp/1789"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# rpc_client.headers = { User-Agent = "jsonrpc-core-client" }')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# piece_token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiMS0xMjUiLCJwZXJtIjoic2lnbiIsImV4dCI6IiJ9.JenwgK0JZcxFDin3cyhBUN41VXNvYw-_0UUT2ZOohM0"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# allowed_miners = [10123, 10124, 10125]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# allowed_sizes = ["32GiB", "64GiB"]')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("enable_deals")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# disable_cc = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# max_deals = 3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# min_deal_space = "8GiB"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("max_retries")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# seal_interval = "30s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# recover_interval = "60s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# rpc_polling_interval = "180s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ignore_proof_check = false")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./mock-tmp/store1"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# plan = "snapup"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.allowed_miners = [10123, 10124, 10125]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.allowed_sizes = ["32GiB", "64GiB"]')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.enable_deals = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.disable_cc = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.max_deals = 3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.min_deal_space = "8GiB"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.max_retries = 3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.seal_interval = "30s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.recover_interval = "60s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.rpc_polling_interval = "180s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.ignore_proof_check = false")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./mock-tmp/store2"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./mock-tmp/store3"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("attached")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# name = "persist-store1"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./mock-tmp/remote"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.limitation.concurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# add_pieces = 5")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pc1 = 3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pc2 = 1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# c2 = 1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.limitation.staggered")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# pc1 = "5min"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# pc2 = "4min"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.ext_locks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# gpu1 = 1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.static_tree_d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 2KiB = "./tmp/2k/sc-02-data-tree-d.dat"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fields for the add_pieces processor")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [[processors.add_pieces]]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fields for tree_d processor")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.tree_d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# auto_restart = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# inherit_envs = true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fields for pc1 processors")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# bin = "./dist/bin/damocles-worker-plugin-pc1"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# args = ["--args-1", "1", --"args-2", "2"]')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4-5"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("RUST_LOG")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# auto_restart = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# inherit_envs = true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6-7"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# auto_restart = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# inherit_envs = true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"12-13"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# auto_restart = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# inherit_envs = true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fields for pc2 processors")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# cgroup.cpuset = "24-27"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# auto_restart = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# inherit_envs = true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"28-31"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# auto_restart = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# inherit_envs = true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fields for c2 processor")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.c2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"32-47"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# auto_restart = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# inherit_envs = true")]),t._v("\n")])])]),a("p",[t._v("Below we will break down the configurable items one by one.")]),t._v(" "),a("h2",{attrs:{id:"worker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#worker"}},[t._v("#")]),t._v(" [worker]")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("worker")]),t._v(" configuration item is used to configure some basic information of this worker instance.")]),t._v(" "),a("h3",{attrs:{id:"basic-configuration-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("worker")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# instance name, optional, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# By default, the IP address of the network card used to connect to `damocles-manager` is used as the instance name")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# name = "worker-#1"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rpc service listening address, optional, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# The default is "0.0.0.0", that is, listening to all addresses of the machine')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# rpc_server.host = "192.168.1.100"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rpc service listening port, optional, number type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default is 17890")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rpc_server.port = 17891")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# local pieces file directory, optional, string array type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# if set, worker will load the piece file from the local file")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# otherwise it will load the remote piece file from damocles-manager")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# If the file "/path/to/{your_local_pieces_dir01, your_local_pieces_dir02, ...}/piece_file_name" does not exist, the worker will also load it from the damocles-manager')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# local_pieces_dirs = ["/path/to/your_local_pieces_dir01", "/path/to/your_local_pieces_dir02"]')]),t._v("\n")])])]),a("p",[t._v("In most cases, each field in this configuration item does not need to be manually configured.")]),t._v(" "),a("p",[t._v("Only in some special cases, such as:")]),t._v(" "),a("ul",[a("li",[t._v("If you would like to name each "),a("code",[t._v("damocles-worker")]),t._v(" instance according to your own naming schemes")]),t._v(" "),a("li",[t._v("If you don't want to monitor all network card IPs and only allow local rpc requests")]),t._v(" "),a("li",[t._v("If multiple "),a("code",[t._v("damocles-worker")]),t._v("s are deployed on one machine, you would like to avoid port conflicts so that they are distinguished")]),t._v(" "),a("li",[t._v("If "),a("code",[t._v("damocles-worker")]),t._v(" can access the piece_store directory, you can set "),a("code",[t._v("local_pieces_dir")]),t._v(" to load piece file locally")])]),t._v(" "),a("p",[t._v("And in other scenarios, you would need to manually configure the options here as needed.")]),t._v(" "),a("h2",{attrs:{id:"metrics"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#metrics"}},[t._v("#")]),t._v(" [metrics]")]),t._v(" "),a("p",[a("code",[t._v("metrics")]),t._v(" provides metrics recorder & exporter (prometheus) options.")]),t._v(" "),a("h3",{attrs:{id:"basic-configuration-example-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-2"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("metrics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Switch of the prometheus exporter, optional，boolean")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default value: false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# When enabled，field "http_listen" will be used to bootstrap a prometheus exporter')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#enable = false")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# prometheus exporter listen address, optional, socket address")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Default value: "0.0.0.0:9000"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#http_listen = "0.0.0.0:9000"')]),t._v("\n")])])]),a("h2",{attrs:{id:"sector-manager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sector-manager"}},[t._v("#")]),t._v(" [sector_manager]")]),t._v(" "),a("p",[a("code",[t._v("sector_manager")]),t._v(" is used to configure "),a("code",[t._v("damocles-manager")]),t._v(" related information so that "),a("code",[t._v("damocles-worker")]),t._v(" can connect to the corresponding service correctly.")]),t._v(" "),a("h3",{attrs:{id:"basic-configuration-example-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-3"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sector_manager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The connection address used when constructing the rpc client, required, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Accepts both `multiaddr` format and url format such as `http://127.0.0.1:1789`, `ws://127.0.0.1:1789`")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Normally, use the `multiaddr` format for consistency with other components")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("rpc_client.addr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/127.0.0.1/tcp/1789"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The http header information when constructing the rpc client, optional, dictionary type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# default is null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# rpc_client.headers = { User-Agent = "jsonrpc-core-client" }')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The verification token carried when requesting deal piece data, optional, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# default is null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This is usually set when this instance allows sealing of sectors with deal data")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The value of this config item is usually the token value of the Venus service used")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# piece_token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiMS0xMjUiLCJwZXJtIjoic2lnbiIsImV4dCI6IiJ9.JenwgK0JZcxFDin3cyhBUN41VXNvYw-_0UUT2ZOohM0"')]),t._v("\n")])])]),a("h2",{attrs:{id:"sealing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sealing"}},[t._v("#")]),t._v(" [sealing]")]),t._v(" "),a("p",[a("code",[t._v("sealing")]),t._v(" is used to configure common parameter options in the sealing process.")]),t._v(" "),a("h3",{attrs:{id:"basic-configuration-example-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-4"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Allowed `SP`, optional, number array format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Defaults to null, allows tasks from any `SP`")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# After configuration, only sealing tasks from `SP` listed in the array can be carried out")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# allowed_miners = [10123, 10124, 10125]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Allowed sector size, optional, string array format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Defaults to null, allows sector tasks of any size")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# After configuration, only tasks that match the sector size listed in the array can be executed")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# allowed_sizes = ["32GiB", "64GiB"]')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Whether to allow adding deals to the sector, optional, boolean type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default is false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# When set to true, the `piece_token` item in `sector_manager` usually needs to be set at the same time")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# enable_deals = true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Whether to disable cc sector, optional, boolean type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default is false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# When enable_deals is true, turn on this option, will keep waiting until a storage deal is obtained, instead of starting sealing cc sectors")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# disable_cc = true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The maximum number of deals allowed to be added to the sector, optional, number type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# default is null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# max_deals = 3")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The minimum size of a deal to be filled in a sector, optional, byte string format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# default is null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# min_deal_space = "8GiB"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Number of retries when an error of `temp` type is encountered during the sealing process, optional, number format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# default is 5")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# max_retries = 3")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Retry interval when a `temp` type error is encountered during the sealing process, optional, time string format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# The default is "30s", which means 30 seconds')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# recover_interval = "30s"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Interval for idle `sealing_thread` to apply for new sealing tasks, optional, time string format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# The default is "30s", which means 30 seconds')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# seal_interval = "30s"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rpc status polling request interval, optional, time string format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# The default is "180s", which means 180 seconds')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# During the sealing process, some links use the polling method to obtain non-real-time information, such as if a message is on-chain.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This value helps to avoid overly frequent requests consuming network resources")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# rpc_polling_interval = "180s"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Whether to skip the local verification step of proof, optional, boolean format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default is false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Usually only set this during testing")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ignore_proof_check = false")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Number of retries when unable to request a task from `sector_manager`, optional, number format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# default is 3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# request_task_max_retries = 3")]),t._v("\n")])])]),a("p",[t._v("The configuration items in "),a("code",[t._v("sealing")]),t._v(" usually have default items preset from experiences, which removes the need for manual configurations in most cases.")]),t._v(" "),a("h3",{attrs:{id:"special-configuration-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#special-configuration-example"}},[t._v("#")]),t._v(" Special configuration example")]),t._v(" "),a("h4",{attrs:{id:"_1-test-network-serving-only-specific-sp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-test-network-serving-only-specific-sp"}},[t._v("#")]),t._v(" 1. Test network, serving only specific "),a("code",[t._v("SP")])]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("allowed_miners")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2234")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2236")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2238")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h4",{attrs:{id:"_2-large-scale-clusters-to-reduce-network-usage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-large-scale-clusters-to-reduce-network-usage"}},[t._v("#")]),t._v(" 2. Large-scale clusters to reduce network usage")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Among the recoverable exceptions, a considerable part is caused by network jitter, increase the interval of automatic recovery and reduce the frequency of requests")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("recover_interval")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"90s"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Increases the interval time to reduces the request frequency")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("rpc_polling_interval")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"300s"')]),t._v("\n")])])]),a("h4",{attrs:{id:"_3-increase-the-possibility-of-self-recovery-from-errors-during-sealing-tasks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-increase-the-possibility-of-self-recovery-from-errors-during-sealing-tasks"}},[t._v("#")]),t._v(" 3. Increase the possibility of self-recovery from errors during sealing tasks")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Increase the number of autorecovery attempts")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("max_retries")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Increase the auto-recovery interval")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("recover_interval")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"60s"')]),t._v("\n")])])]),a("h2",{attrs:{id:"sealing-thread"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sealing-thread"}},[t._v("#")]),t._v(" [[sealing_thread]]")]),t._v(" "),a("p",[t._v("Each "),a("code",[t._v("sealing_thread")]),t._v(" is used to configure a worker thread for a sector. Multiple "),a("code",[t._v("sealing_thread")]),t._v(" configuration groups can exist in one configuration file.")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("sealing_thread")]),t._v(" will inherit the configuration in "),a("RouterLink",{attrs:{to:"/operation/damocles-worker-config.html#sealing"}},[a("code",[t._v("[sealing]")])]),t._v(". Any "),a("code",[t._v("sealing.*")]),t._v(" in the "),a("code",[t._v("sealing_thread")]),t._v(" configuration will override the configuration of "),a("code",[t._v("[sealing]")]),t._v(".")],1),t._v(" "),a("h3",{attrs:{id:"basic-configuration-example-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-5"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Sector data directory path, required, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# It is recommended to use an absolute path, the data directory and the worker thread are binded in one-to-one relationship")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/nvme1/store"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# task type, optional, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default value is null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# All options: sealer | snapup | rebuild | unseal | wdpost, when left blank, the default is `sealer`")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# plan = "snapup"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Custom parameters of the sealing process, only applies to the current worker thread")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.allowed_miners = [10123, 10124, 10125]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.allowed_sizes = ["32GiB", "64GiB"]')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.enable_deals = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.disable_cc = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.max_retries = 3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.seal_interval = "30s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.recover_interval = "60s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.rpc_polling_interval = "180s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.ignore_proof_check = false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.request_task_max_retries = 3")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/nvme2/store"')]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/nvme3/store"')]),t._v("\n")])])]),a("p",[t._v("The number of "),a("code",[t._v("sealing_thread")]),t._v(" and the corresponding sealing data directory paths need to be planned according to your specific situation.")]),t._v(" "),a("p",[t._v("In order to facilitate combination and matching, each "),a("code",[t._v("sealing_thread")]),t._v(" can be configured with an independent "),a("code",[t._v("sealing")]),t._v(" sub-item, which satisfies:")]),t._v(" "),a("ul",[a("li",[t._v("The naming, type and effect of configurable items are consistent with the common "),a("code",[t._v("sealing")]),t._v(" items")]),t._v(" "),a("li",[t._v("Only applies to the current worker thread")]),t._v(" "),a("li",[t._v("When not configured use the value in the common "),a("code",[t._v("sealing")]),t._v(" item")])]),t._v(" "),a("h3",{attrs:{id:"special-configuration-example-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#special-configuration-example-2"}},[t._v("#")]),t._v(" Special configuration example")]),t._v(" "),a("h4",{attrs:{id:"_1-two-worker-threads-each-serving-a-different-sp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-two-worker-threads-each-serving-a-different-sp"}},[t._v("#")]),t._v(" 1. Two worker threads, each serving a different "),a("code",[t._v("SP")])]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/nvme2/store"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("sealing.allowed_miners")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1357")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/nvme3/store"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("sealing.allowed_miners")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2468")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h4",{attrs:{id:"_2-two-worker-threads-each-with-different-sector-sizes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-two-worker-threads-each-with-different-sector-sizes"}},[t._v("#")]),t._v(" 2. Two worker threads, each with different sector sizes")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/nvme2/store"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("sealing.allowed_sizes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"32GiB"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/nvme3/store"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("sealing.allowed_sizes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"64GiB"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h3",{attrs:{id:"sealing-thread-configuration-hot-reload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sealing-thread-configuration-hot-reload"}},[t._v("#")]),t._v(" sealing_thread configuration hot reload")]),t._v(" "),a("p",[t._v("Before damocles "),a("code",[t._v("v0.5.0")]),t._v(", we could only update the configuration by modifying the "),a("code",[t._v("sealing_thread")]),t._v(" configuration and restarting damocles-worker.\nIt is very inconvenient in some scenarios, for example: during "),a("a",{attrs:{href:"https://github.com/sector-rebuild.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sector rebuild"),a("OutboundLink")],1),t._v(" we would like to be able to reload configuration without rebooting damocles-worker after modifying the "),a("code",[t._v("plan")]),t._v(" configuration item of a "),a("code",[t._v("sealing_thread")]),t._v(".")]),t._v(" "),a("p",[a("code",[t._v("sealing_thread")]),t._v(" configuration hot reload is supported after "),a("code",[t._v("v0.5.0")]),t._v(". By creating a hot reload configuration file named "),a("code",[t._v("config.toml")]),t._v(" under the "),a("code",[t._v("location")]),t._v(" directory in a "),a("code",[t._v("sealing_thread")]),t._v(" with definitions of the configuration file exactly the same as the content of "),a("a",{attrs:{href:"#sealing_thread"}},[a("code",[t._v("[[sealing_thread]]")])]),t._v(", the configuration items in this configuration file will override the corresponding "),a("code",[t._v("[[sealing_thread]]")]),t._v(" configuration items in damocles-worker, and modifying this configuration file does not require restarting damocles-worker to take effect.")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("sealing_thread")]),t._v(" in "),a("code",[t._v("damocles-worker")]),t._v(" will check the "),a("code",[t._v("config.toml")]),t._v(" file in the "),a("code",[t._v("location")]),t._v(" directory before starting a new sector task. A reload or removal of the configuration will be triggered, if the content of the "),a("code",[t._v("config.toml")]),t._v(" file is either changed or the file is deleted.")]),t._v(" "),a("p",[a("strong",[t._v("Notice:")])]),t._v(" "),a("ul",[a("li",[t._v("Hot reload of configuration file "),a("code",[t._v("config.toml")]),t._v(" cannot override the "),a("code",[t._v("location")]),t._v(" configuration item in "),a("code",[t._v("sealing_thread")]),t._v(".")]),t._v(" "),a("li",[a("code",[t._v("damocles-worker")]),t._v(" main configuration file does not support hot reload.")])]),t._v(" "),a("h4",{attrs:{id:"basic-configuration-example-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-6"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /path/to/the_sealing_thread_location/config.toml")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Task type, optional, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default value is null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# All options: sealer | snapup | rebuild | unseal | wdpost, if not filled, the default is sealer")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# plan = "rebuild"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Custom parameters of the sealing process, only effective on the current worker thread")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.allowed_miners = [10123, 10124, 10125]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.allowed_sizes = ["32GiB", "64GiB"]')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.enable_deals = true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.max_retries = 3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.seal_interval = "30s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.recover_interval = "60s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing.rpc_polling_interval = "180s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.ignore_proof_check = false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.request_task_max_retries = 3")]),t._v("\n")])])]),a("h2",{attrs:{id:"attached"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#attached"}},[t._v("#")]),t._v(" [[attached]]")]),t._v(" "),a("p",[a("code",[t._v("attached")]),t._v(" is used to configure where the sealed sector persistent data is saved. Multiple configuration entries are allowed at the same time.")]),t._v(" "),a("h3",{attrs:{id:"basic-configuration-example-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-7"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("attached")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# name, optional, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The default is the absolute path corresponding to the location")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# name = "remote-store1"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# path, required, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# It is recommended to fill in the absolute path directly")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/remote/10.0.0.14/store"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# read only, optional, boolean")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default is false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# readonly = true")]),t._v("\n\n")])])]),a("p",[t._v("With the need to coordinate storage location information between "),a("code",[t._v("damocles-worker")]),t._v(" and "),a("code",[t._v("damocles-manager")]),t._v(" in mind and the fact that in many cases the same persistent storage directory mount path on the "),a("code",[t._v("damocles-worker")]),t._v(" machine and on the "),a("code",[t._v("damocles-manager")]),t._v(" machine are not exactly the same, so we decided to use "),a("code",[t._v("name")]),t._v(" as the basis for coordination.")]),t._v(" "),a("p",[t._v("You can also choose not to configure "),a("code",[t._v("name")]),t._v(" on both sides of "),a("code",[t._v("damocles-worker")]),t._v(" and "),a("code",[t._v("damocles-manager")]),t._v(" during configuration if the mount path of the persistent storage directory is the same on all machines. In this case, both will use the absolute path as the "),a("code",[t._v("name")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"processors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processors"}},[t._v("#")]),t._v(" [processors]")]),t._v(" "),a("p",[a("code",[t._v("processors")]),t._v(" is used to configure sealing task executors, and some other information during sealing.")]),t._v(" "),a("p",[t._v("This configuration item is actually divided into three sub-items, and we shall analyze them one by one.")]),t._v(" "),a("h3",{attrs:{id:"processors-limitation-concurrent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processors-limitation-concurrent"}},[t._v("#")]),t._v(" [processors.limitation.concurrent]")]),t._v(" "),a("p",[t._v("When both "),a("code",[t._v("[processors.limit]")]),t._v(" and "),a("code",[t._v("[processors.limitation.concurrent]")]),t._v(" exist in the configuration file, the latter shall override.")]),t._v(" "),a("p",[a("code",[t._v("processors.limitation.concurrent")]),t._v(" is used to configure the number of parallel tasks for a specific sealing task. This is to reduce the contention of hardware resources at one given  sealing stage.")]),t._v(" "),a("p",[t._v("It should be noted that when external processors are configured, the number of external processors and the total allowed concurrency will also affect the number of parallel tasks.")]),t._v(" "),a("h4",{attrs:{id:"basic-configuration-example-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-8"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.limitation.concurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Consurrency limit for add_pieces task, optional, number_type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# add_pieces = 5")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Consurrency limit for tree_d task, optional, number type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tree_d = 1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Concurrency limit for the pc1 task, optional, number type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pc1 = 3")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Concurrency limit of the pc2 task, optional, number type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pc2 = 2")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Concurrency limit for task c2, optional, number type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# c2 = 1")]),t._v("\n")])])]),a("p",[t._v("For example, if "),a("code",[t._v("pc2 = 2")]),t._v(" is set, then at most two sectors can perform "),a("code",[t._v("pc2")]),t._v(" task at the same time.")]),t._v(" "),a("h3",{attrs:{id:"processors-limitation-staggered"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processors-limitation-staggered"}},[t._v("#")]),t._v(" [processors.limitation.staggered]")]),t._v(" "),a("p",[a("code",[t._v("processors.limitation.staggered")]),t._v(" is used to configure the time interval for staggered startup of parallel tasks during a given sealing phase. After configuring this item, when multiple tasks are scheduled at the same time for a given sealing phase, "),a("code",[t._v("damocles-worker")]),t._v(" will start the tasks in sequence according to the configured time interval, so as to avoid the problem of resource shortage such as slowdown of disk IO caused by the simultaneous start of tasks.")]),t._v(" "),a("h4",{attrs:{id:"basic-configuration-example-9"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-9"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.limitation.staggered")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# The time interval for starting multiple pc1 tasks in sequence, optional, string type (e.g. "1s", "2min")')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# pc1 = "5min"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# pc2 = "4min"')]),t._v("\n")])])]),a("p",[t._v("For example, if "),a("code",[t._v('pc1 = "5min"')]),t._v(" is set, when two pc1 tasks are scheduled at the same time, the second task will be executed after 5 minutes into the execution of the first task.")]),t._v(" "),a("h3",{attrs:{id:"processors-ext-locks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processors-ext-locks"}},[t._v("#")]),t._v(" [processors.ext_locks]")]),t._v(" "),a("p",[a("code",[t._v("processors.ext_locks")]),t._v(" is used to configure some custom lock restrictions, which is used in conjunction with the "),a("code",[t._v("locks")]),t._v(" configuration item in "),a("code",[t._v("[[processors.{stage_name}]]")]),t._v(".\nThis configuration item allows users to customize some restrictions and make different external processors subject to them.")]),t._v(" "),a("h4",{attrs:{id:"basic-configuration-example-10"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-10"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.ext_locks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# some_name = some_number")]),t._v("\n")])])]),a("h4",{attrs:{id:"special-configuration-example-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#special-configuration-example-3"}},[t._v("#")]),t._v(" Special configuration example")]),t._v(" "),a("p",[a("code",[t._v("processors.ext_locks")]),t._v(" by itself does not apply the lock.")]),t._v(" "),a("h5",{attrs:{id:"one-gpu-shared-by-pc2-and-c2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#one-gpu-shared-by-pc2-and-c2"}},[t._v("#")]),t._v(" one GPU, shared by pc2 and c2")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.ext_locks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("gpu")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("locks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gpu"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.c2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("locks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gpu"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("By this way, "),a("code",[t._v("pc2")]),t._v(" "),a("code",[t._v("c2")]),t._v(" will each start an external processor, and the two will compete for the lock, which means that the two tasks will not happen at the same time.")]),t._v(" "),a("h5",{attrs:{id:"two-gpu-shared-by-pc2-and-c2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#two-gpu-shared-by-pc2-and-c2"}},[t._v("#")]),t._v(" Two GPU, shared by pc2 and c2")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.ext_locks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("gpu1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("gpu2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("locks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gpu1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("locks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gpu2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.c2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("locks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gpu1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.c2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("locks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gpu2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("In this way, "),a("code",[t._v("pc2")]),t._v(" "),a("code",[t._v("c2")]),t._v(" will each start two external processors, which will create a two-two competition relationship, which allows to limit a GPU to only execute one of the sealing tasks.")]),t._v(" "),a("h3",{attrs:{id:"processors-static-tree-d"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processors-static-tree-d"}},[t._v("#")]),t._v(" [processors.static_tree_d]")]),t._v(" "),a("p",[a("code",[t._v("processors.static_tree_d")]),t._v(" is a configuration item introduced to improve the efficiency of "),a("code",[t._v("cc sector")]),t._v(".")]),t._v(" "),a("p",[t._v("When a static file path is configured for the corresponding sector size, this file will be used directly as the tree_d file for "),a("code",[t._v("cc sector")]),t._v(" without trying to generate it again.")]),t._v(" "),a("h4",{attrs:{id:"basic-configuration-example-11"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-11"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.static_tree_d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("2KiB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/var/tmp/2k/sc-02-data-tree-d.dat"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("32GiB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/var/tmp/32g/sc-02-data-tree-d.dat"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("64GiB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/var/tmp/64g/sc-02-data-tree-d.dat"')]),t._v("\n")])])]),a("h3",{attrs:{id:"processors-stage-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processors-stage-name"}},[t._v("#")]),t._v(" [[processors.{stage_name}]]")]),t._v(" "),a("p",[t._v("This is the configuration group used to configure external processors.")]),t._v(" "),a("p",[t._v("Currently "),a("code",[t._v("{stage_name}")]),t._v(" could be one of the following.")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("add_pieces")]),t._v(" for add pieces phase")]),t._v(" "),a("li",[a("code",[t._v("tree_d")]),t._v(" for generation phase of Tree D")]),t._v(" "),a("li",[a("code",[t._v("pc1")]),t._v(" for the PreCommit1 phase")]),t._v(" "),a("li",[a("code",[t._v("pc2")]),t._v(" for the PreCommit2 phase")]),t._v(" "),a("li",[a("code",[t._v("synth_proof")]),t._v(" for the synthetic proof phase")]),t._v(" "),a("li",[a("code",[t._v("c2")]),t._v(": for Commit2 phase")]),t._v(" "),a("li",[a("code",[t._v("unseal")]),t._v(": for unseal phase")]),t._v(" "),a("li",[a("code",[t._v("transfer")]),t._v(": used to customize the transfer method between local data and persistent data storage")])]),t._v(" "),a("p",[t._v("Each such configuration group translates to an external processor of the corresponding sealing phase to be started. If nothing is configured for one of the above "),a("code",[t._v("{stage_name}")]),t._v(" and corresponding "),a("code",[t._v("[[processors.{stage_name}]]")]),t._v(" line does not exist in the configuration file,\nthen "),a("code",[t._v("damocles-worker")]),t._v(" will not start a child process for this "),a("code",[t._v("{stage_name}")]),t._v(". "),a("code",[t._v("damocles-worker")]),t._v(" will use the built-in processor code to directly execute the corresponding "),a("code",[t._v("{stage_name}")]),t._v(" task in "),a("code",[t._v("sealing_thread")]),t._v(", which means that the concurrent number of "),a("code",[t._v("{stage_name}")]),t._v(" tasks depends on the corresponding number of "),a("code",[t._v("sealing_thread")]),t._v(" and concurrent number of "),a("code",[t._v("{stage_name}")]),t._v(" as configured in "),a("code",[t._v("[processors.limitation.concurrent]")]),t._v(". By not configuring external processor saves extra steps such as serializing task parameters and task output, but one loses capabilities such as more powerful concurrency control, cgroup control, and custom proof algorithms. You are feel to choose according to your own needs.")]),t._v(" "),a("p",[t._v("The optional configuration items for "),a("code",[t._v("[[processors.{stage_name}]]")]),t._v(" include:")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Custom external processor executable file path, optional, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# By default, the executable file path corresponding to the main process will be used, Execute the damocles-worker builtin processor")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# bin = "./dist/bin/damocles-worker-plugin-pc1"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Customize the parameters of the external processor, optional item, string array type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The default value is null, `damocles-worker`'s own executor default parameters will be used")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# args = ["--args-1", "1", --"args-2", "2"]')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Time to get ready of external child-processes, optional, time string")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The default value is 5s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# stable_wait = "5s"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# numa affinity partition id, optional, number type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default value is null, no affinity will be set")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Need to fill in according to the host's numa partition")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# numa_preferred = 0")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cpu core binding and limit options, optional, string type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The default value is null, no binding is set")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The format of the value follows the standard cgroup.cpuset format")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# cgroup.cpuset = "4-5"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Additional environment variables for external processors, optional, dictionary type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default value is null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# envs = { RUST_LOG = "info" }')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The maximum number of concurrent tasks allowed by this executor")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The default value is null, unlimited, but whether the task is executed concurrently depends on the implementation of the external processor used")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Mainly used in pc1 so that multiple parallel links can be used, which can effectively save resources such as shared memory and thread pools")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# concurrent = 4")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Custom external limit lock name, optional, string array type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default value is null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# locks = ["gpu1"]')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Whether to restart automatically when a child process exits, optional, bool type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default is true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# auto_restart = true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Whether to inherit the environment variables from the worker daemon process, optional, bool type")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default is true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# inherit_envs = true")]),t._v("\n")])])]),a("h4",{attrs:{id:"basic-configuration-example-12"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration-example-12"}},[t._v("#")]),t._v(" Basic configuration example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.limit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("add_pieces")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("pc1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("pc2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("c2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0-7"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_MULTICORE_SDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("auto_restart")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"12-19"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_MULTICORE_SDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("auto_restart")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8-11,24-27"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_COLUMN_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_TREE_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("CUDA_VISIBLE_DEVICES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("auto_restart")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"20-23,36-39"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_COLUMN_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_TREE_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("CUDA_VISIBLE_DEVICES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("auto_restart")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.c2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"28-35"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("CUDA_VISIBLE_DEVICES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2,3"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("auto_restart")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.tree_d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"40-45"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("auto_restart")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n")])])]),a("p",[t._v("The above is an example "),a("code",[t._v("processors.{stage_name}")]),t._v(" configuration for a 48C + 4GPU box. Under this configuration, it will start:")]),t._v(" "),a("ul",[a("li",[t._v("2 "),a("code",[t._v("pc1")]),t._v(" external processors, both using "),a("code",[t._v("MULTICORE_SDR")]),t._v(" mode, each with 8 cores, allowing 2 concurrent tasks, and memory allocation preferentially uses its configured numa partition")]),t._v(" "),a("li",[t._v("2 "),a("code",[t._v("pc2")]),t._v(" external processors, each with 8 cores, each using one GPU")]),t._v(" "),a("li",[t._v("1 "),a("code",[t._v("c2")]),t._v(" external processor, allocated 8 cores, using one GPU")]),t._v(" "),a("li",[t._v("1 "),a("code",[t._v("tree_d")]),t._v(" external processor with 6 cores allocated")])]),t._v(" "),a("h4",{attrs:{id:"special-configuration-example-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#special-configuration-example-4"}},[t._v("#")]),t._v(" Special configuration example")]),t._v(" "),a("h5",{attrs:{id:"_1-using-user-defined-closed-source-algorithmically-optimized-c2-external-processor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-using-user-defined-closed-source-algorithmically-optimized-c2-external-processor"}},[t._v("#")]),t._v(" 1. Using user-defined closed source, algorithmically optimized c2 external processor")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.c2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("bin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/usr/local/bin/damocles-worker-c2-optimized"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"40-47"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("CUDA_VISIBLE_DEVICES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2,3"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h5",{attrs:{id:"_2-c2-external-processor-using-outsourced-mode-remote-computation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-c2-external-processor-using-outsourced-mode-remote-computation"}},[t._v("#")]),t._v(" 2. c2 external processor using outsourced mode (remote computation)")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.c2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("bin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/usr/local/bin/damocles-worker-c2-outsource"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("args")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--url"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/apis.filecoin.io/tcp/10086/https"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--timeout"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10s"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("LICENCE_PATH")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/var/tmp/c2.licence.dev"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h5",{attrs:{id:"_3-use-cpu-mode-to-make-up-for-pc2-computing-power-when-gpu-is-lacking"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-use-cpu-mode-to-make-up-for-pc2-computing-power-when-gpu-is-lacking"}},[t._v("#")]),t._v(" 3. Use CPU mode to make up for pc2 computing power when GPU is lacking")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8-11,24-27"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_COLUMN_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_TREE_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("CUDA_VISIBLE_DEVICES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"20-23,36-45"')]),t._v("\n")])])]),a("h5",{attrs:{id:"_4-under-the-optimal-planning-the-total-amount-of-pc1-is-odd-and-cannot-be-divided-equally"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-under-the-optimal-planning-the-total-amount-of-pc1-is-odd-and-cannot-be-divided-equally"}},[t._v("#")]),t._v(" 4. Under the optimal planning, the total amount of pc1 is odd and cannot be divided equally")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.limitation.concurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("pc1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("pc2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("c2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0-41"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_MULTICORE_SDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"48-92"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_MULTICORE_SDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h5",{attrs:{id:"_5-to-prioritize-numa-0-area-for-pc1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-to-prioritize-numa-0-area-for-pc1"}},[t._v("#")]),t._v(" 5. To prioritize numa 0 area for pc1")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.limit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("pc1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("pc2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("c2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0-47"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_MULTICORE_SDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"48-86"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_MULTICORE_SDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"cgroup-cpuset-configuration-notes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cgroup-cpuset-configuration-notes"}},[t._v("#")]),t._v(" "),a("code",[t._v("cgroup.cpuset")]),t._v(" Configuration Notes")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("For PC1 external processors with multicore SDR enabled, "),a("code",[t._v("cgroup.cpuset")]),t._v(" should use the entirety of the CPU cores under one L3 cache as a base unit for configuration as much as possible. If you need to configure portion of CPU cores under one L3 cache, you must make sure that the number of CPU cores under each L3 cache is the same.")]),t._v(" "),a("p",[t._v("According to "),a("a",{attrs:{href:"https://github.com/filecoin-project/rust-fil-proofs",target:"_blank",rel:"noopener noreferrer"}},[t._v("rust-fil-proofs"),a("OutboundLink")],1),t._v(", when "),a("code",[t._v("multicore sdr")]),t._v(" is enabled, the number of CPU cores and number of corresponding cores on single DIE must be an integer multiple relationship. If the external processor is using rust-fil-proofs or rust-fil-proofs based variants, this rule must be followed, otherwise it can be ignored. The default processor of damocles-worker is based on rust-fil-proofs.")])]),t._v(" "),a("li",[a("p",[t._v("The CPU cores in "),a("code",[t._v("cgroup.cpuset")]),t._v(" should not span NUMA nodes as much as possible. Across NUMA nodes will make CPU access to memory slower. ("),a("strong",[a("code",[t._v("damocles")]),t._v(" "),a("a",{attrs:{href:"https://github.com/hugeTLB.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("supports loading NUMA affinity "),a("code",[t._v("hugepage")]),t._v(" memory files"),a("OutboundLink")],1),t._v(" after v0.5.0, if this feature is enabled then you can allocate "),a("code",[t._v("cpusets")]),t._v(" across NUMA nodes without concerns")]),t._v(")")]),t._v(" "),a("p",[t._v("If the configured CPU cores are on the same NUMA node, "),a("code",[t._v("processors.{stage_name}.numa_preferred")]),t._v(" can be configured with the corresponding NUMA node id.")])])]),t._v(" "),a("p",[t._v("Use "),a("RouterLink",{attrs:{to:"/operation/12.damocles-worker-util.html#hwinfo"}},[t._v("damocles-worker-util")]),t._v(" to check CPU information")],1),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("./damocles-worker-util hwinfo\n")])])]),a("p",[t._v("Output:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("CPU topology:\nMachine (503.55 GiB)\n├── Package (251.57 GiB) (*** *** *** 32-Core Processor)\n│ ├── NUMANode (#0 251.57 GiB)\n│ ├── L3 (#0 16 MiB)\n│ │ └── PU #0 + PU #1 + PU #2 + PU #3\n│ ├── L3 (#1 16 MiB)\n│ │ └── PU #4 + PU #5 + PU #6 + PU #7\n│ ├── L3 (#2 16 MiB)\n│ │ └── PU #8 + PU #9 + PU #10 + PU #11\n│ ├── L3 (#3 16 MiB)\n│ │ └── PU #12 + PU #13 + PU #14 + PU #15\n│ ├── L3 (#4 16 MiB)\n│ │ └── PU #16 + PU #17 + PU #18 + PU #19\n│ ├── L3 (#5 16 MiB)\n│ │ └── PU #20 + PU #21 + PU #22 + PU #23\n│ ├── L3 (#6 16 MiB)\n│ │ └── PU #24 + PU #25 + PU #26 + PU #27\n│ └── L3 (#7 16 MiB)\n│ └── PU #28 + PU #29 + PU #30 + PU #31\n└── Package (251.98 GiB) (*** *** *** 32-Core Processor)\n    ├── NUMANode (#1 251.98 GiB)\n    ├── L3 (#8 16 MiB)\n    │ └── PU #32 + PU #33 + PU #34 + PU #35\n    ├── L3 (#9 16 MiB)\n    │ └── PU #36 + PU #37 + PU #38 + PU #39\n    ├── L3 (#10 16 MiB)\n    │ └── PU #40 + PU #41 + PU #42 + PU #43\n    ├── L3 (#11 16 MiB)\n    │ └── PU #44 + PU #45 + PU #46 + PU #47\n    ├── L3 (#12 16 MiB)\n    │ └── PU #48 + PU #49 + PU #50 + PU #51\n    ├── L3 (#13 16 MiB)\n    │ └── PU #52 + PU #53 + PU #54 + PU #55\n    ├── L3 (#14 16 MiB)\n    │ └── PU #56 + PU #57 + PU #58 + PU #59\n    └── L3 (#15 16 MiB)\n        └── PU #60 + PU #61 + PU #62 + PU #63\n...\n")])])]),a("p",[t._v("From the output information, we can see that this machine has two NUMANodes, each NUMANode has 8 L3 Caches, and each L3 cache has 4 CPU cores.")]),t._v(" "),a("ul",[a("li",[t._v("CPU cores on NUMANode #0: 0-31")]),t._v(" "),a("li",[t._v("CPU cores on NUMANode #1: 31-63")])]),t._v(" "),a("p",[t._v("Using this machine as an example, configuration like "),a("code",[t._v('processors.pc1.cgroup.cpuset = "0-6"')]),t._v(" does not satisfy the rust-fil-proofs rule.")]),t._v(" "),a("ol",[a("li",[t._v("PU#0, PU#1, PU#2, PU#3, these 4 CPU cores belong to L3#0")]),t._v(" "),a("li",[t._v("PU#4, PU#5, PU#6, these 3 CPU cores belong to L3#1")])]),t._v(" "),a("p",[t._v("The number of shared caches of is 2 (L3#0, L3#1), and the number of configured CPU cores is inconsistent, which does not meet the "),a("code",[t._v("rust-fil-proofs")]),t._v(" rule and cannot be started. The correct configuration could be "),a("code",[t._v('processors.pc1.cgroup.cpuset = "0-7"')]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"a-minimal-working-configuration-file-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#a-minimal-working-configuration-file-example"}},[t._v("#")]),t._v(" A minimal working configuration file example")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sector_manager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("rpc_client.addr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/{some_ip}/tcp/1789"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# According to actual resource planning")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to sealing store1}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to sealing store2}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to sealing store3}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to sealing store4}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to sealing store5}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to sealing store6}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to sealing store7}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to sealing store8}"')]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("remote_store")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{remote store name}"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to remote store}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.static_tree_d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("32GiB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to static tree_d for 32GiB}"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("64GiB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{path to static tree_d for 64GiB}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# According to actual resource planning")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.limit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("pc1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("pc2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("c2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0-7"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_MULTICORE_SDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("numa_preferred")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"12-19"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_MULTICORE_SDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8-11,24-27"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_COLUMN_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_TREE_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("CUDA_VISIBLE_DEVICES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.pc2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"20-23,36-39"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_COLUMN_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("FIL_PROOFS_USE_GPU_TREE_BUILDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("CUDA_VISIBLE_DEVICES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.c2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"28-35"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("CUDA_VISIBLE_DEVICES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2,3"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.tree_d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("cgroup.cpuset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"40-45"')]),t._v("\n")])])]),a("p",[t._v("After planning according to the actual situation and filling in the corresponding information, the above is a minimal working configuration file that...")]),t._v(" "),a("ul",[a("li",[t._v("Does "),a("code",[t._v("cc sector")]),t._v(" only")]),t._v(" "),a("li",[t._v("Optimized tree_d generation for 32GiB and 64GiB sectors")]),t._v(" "),a("li",[t._v("Integrated resource allocation")])]),t._v(" "),a("h4",{attrs:{id:"references-to-the-venus-community-test-cases"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#references-to-the-venus-community-test-cases"}},[t._v("#")]),t._v(" References to the Venus community test cases")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/ipfs-force-community/damocles/blob/main/docs/example/Example-1.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reference Example 1"),a("OutboundLink")],1),t._v("\nTakeaways: PC1 is precisely limited to cores, and C2 is completed by gpuproxy, which has strong scalability. The disadvantage is that the configuration is complex, and the number of tasks needs to be adjusted according to the actual hardware specs")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/ipfs-force-community/damocles/blob/main/docs/example/Example-2.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reference Example 2"),a("OutboundLink")],1),t._v("\nTakeaways: PC2 and C2 share 1 GPU, may cause some C2 tasks be backlogged")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/ipfs-force-community/damocles/blob/main/docs/example/Example-3.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reference Example 3"),a("OutboundLink")],1),t._v("\nTakeaways: 2 sets of PC2 share GPU resources with 2 sets of C2 respectively")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/ipfs-force-community/damocles/blob/main/docs/example/Example-4.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reference Example 4"),a("OutboundLink")],1),t._v("\nTakeaways: Suitable for lower end machines, creates 96G of swap space on NVMe, but this may cause some tasks to be slower")])])}),[],!1,null,null,null);s.default=n.exports}}]);