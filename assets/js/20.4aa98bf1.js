(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{386:function(t,e,s){"use strict";s.r(e);var a=s(17),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"standalone-poster-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#standalone-poster-node"}},[t._v("#")]),t._v(" Standalone PoSter node")]),t._v(" "),s("p",[t._v("In earlier versions, although "),s("code",[t._v("damocles-manager")]),t._v(" supports using "),s("code",[t._v("--poster")]),t._v(" and "),s("code",[t._v("--miner")]),t._v(" parameters of the "),s("code",[t._v("daemon run")]),t._v(" command to enable the corresponding module, the "),s("code",[t._v("post")]),t._v(" proof process is still of strong correlation with sector location information which makes it more limited and difficult to expand.")]),t._v(" "),s("p",[t._v("From v0.2.0 onwards, we have provided a series of function combinations that make easy-to-use, scalable standalone PoSter nodes an option for "),s("code",[t._v("SP")]),t._v(" of "),s("strong",[t._v("large-scale operations")]),t._v(" and "),s("strong",[t._v("multiple miner ids")]),t._v(".")]),t._v(" "),s("p",[t._v("Below, we will introduce these new features and provide a practice to complete the deployment of standalone PoSter nodes using these features. Subsequent documents use the node with "),s("code",[t._v("--poster")]),t._v(" enabled as an example, and the standalone "),s("code",[t._v("--miner")]),t._v(" node operates in a similar manner, which will not be described separately.")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("From version v0.8.0 and onwards, damocles supports three ways to run PoSter nodes independently, namely worker-prover mode, proxy node mode, and ext-prover mode (external executor mode).")]),t._v(" "),s("h2",{attrs:{id:"worker-prover-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#worker-prover-mode"}},[t._v("#")]),t._v(" worker-prover mode")]),t._v(" "),s("p",[t._v("The worker-prover mode is a new feature of v0.8.0. It is characterized by simplicity and can support multi-machine wdpost (with coordination and redundancy) very easily.")]),t._v(" "),s("h3",{attrs:{id:"fundamental"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fundamental"}},[t._v("#")]),t._v(" Fundamental")]),t._v(" "),s("p",[t._v("The worker-prover mode uses damocles-worker to compute the window post proof, obtains the window post task from damocles-manager through RPC and returns the computation result.")]),t._v(" "),s("p",[t._v("damocles-worker adds wdpost planner for executing window post tasks.")]),t._v(" "),s("h4",{attrs:{id:"architecture"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#architecture"}},[t._v("#")]),t._v(" Architecture")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("                +-----------------------------------+\n                |     damocles-manager daemon       |\n                |     with --worker-prover flag     |\n                |                                   |\n                |        +-----------------+        |\n                |        |damocles-manager |        |\n                |        |  poster module  |        |\n                |        +-------+-^-------+        |\n                |           send | |recv            |\n                |                | |                |\n                |        +-------v-+-------+        |\n                |        |  worker-prover  |        |\n       +--------+--------\x3e      module     <--------+--------+\n       |        |        +--------^--------+        |        |\n       |        |                 |                 |        |\n       |        +-----------------+-----------------+        |\n       |                          |                          |\n-------+--------------------------+--------------------------+------------\n       |                          |                          |\n       | pull job                 | pull job                 | pull job\n       | push res                 | push res                 | push res\n       | by rpc                   | by rpc                   | by rpc\n       |                          |                          |\n+------+--------+         +-------+-------+           +------+--------+\n|damocles-worker|         |damocles-worker|           |damocles-worker|\n|wdpost planner |         |wdpost planner |  ...      |wdpost planner |\n+---------------+         +---------------+           +---------------+\n")])])]),s("h3",{attrs:{id:"damocles-manager-configuration-and-startup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#damocles-manager-configuration-and-startup"}},[t._v("#")]),t._v(" Damocles-manager Configuration and Startup")]),t._v(" "),s("p",[t._v("New configuration:")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ~/.damocles-manager/sector-manager.cfg")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Common.Proving.WorkerProver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The maximum number of attempts of the WindowPoSt task, optional, number type")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default value is 2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The WindowPoSt task whose number of attempts exceeds JobMaxTry can only be re-executed by manually resetting")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("JobMaxTry")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# WindowPoSt task heartbeat timeout, optional, time string type")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default value is 15s")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Tasks that have not sent a heartbeat for more than this amount of time will be set as failed and retried")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("HeartbeatTimeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"15s"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# WindowPoSt task timeout, optional, time string type")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default value is 25h")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# WindowPoSt tasks whose creation time exceeds this time will be deleted")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("JobLifetime")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"25h0m0s"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#...")]),t._v("\n")])])]),s("p",[t._v("Start the damocles-manager process:")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# --miner flag is optional to add, which means to start the miner module to execute WinningPoSt and produce blocks")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# --poster flag must be added, which means to start the WindowPoSt module")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# --worker-prover must be added, indicating that the WorkerProver module is used to execute WindowPoSt")]),t._v("\n./damocles-manager daemon run --miner --poster --worker-prover\n")])])]),s("h3",{attrs:{id:"damocles-worker-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#damocles-worker-configuration"}},[t._v("#")]),t._v(" damocles-worker configuration")]),t._v(" "),s("p",[t._v("Configuration walkthrough:")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Configure to use wdpost plan")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("plan")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wdpost"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The configuration limits the execution of the task to the specified miner id; if it is left empty, it means no limit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.allowed_miners = [6666, 7777]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Configure tasks that only allow sectors of the specified size to run")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# allowed_sizes = ["32GiB", "64GiB"]')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("attached")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Configure the permanent storage that this worker will use during the execution of the window post task")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"miner-6666-store"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/miner-6666-store"')]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Control window_post task concurrency (optional), no limit if not configured")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors.limitation.concurrent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("window_post")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors. window_post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Use a custom wdpost proof (optional), if you do not configure bin, the built-in proof will be used by default")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("bin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"~/my_algorithm"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("args")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"window_post"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Limit the cpuset to this sub processes")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# cgroup.cpuset = "10-19"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Configure environment variables for custom proof (optional)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("BELLMAN_GPU_INDEXS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("CUDA_VISIBLE_DEVICES")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("TMPDIR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tmp/worker-prover1/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Configure the maximum concurrent number of this process (optional), no limit if not configured")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])]),s("h5",{attrs:{id:"a-simple-example-configuration-to-start-just-one-wdpost-sealing-thread-is-as-follows"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#a-simple-example-configuration-to-start-just-one-wdpost-sealing-thread-is-as-follows"}},[t._v("#")]),t._v(" A simple example configuration to start just one wdpost sealing_thread is as follows:")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /path/to/your-damocles-worker-config.toml")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("worker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"damocles-worker-USA-01"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sector_manager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("rpc_client.addr")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/your-damocles-manager-address-here/tcp/1789"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("plan")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wdpost"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The time interval for trying to claim tasks, the default is 60s,")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# For wdpost plan, we can reduce this value to get new wdpost tasks faster")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("sealing.recover_interval")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"15s"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sealing.allowed_miners = [6666]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sealing. allowed_sizes = ["32GiB"]')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("attached")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"miner-6666-store"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/miner-6666-store"')]),t._v("\n")])])]),s("h5",{attrs:{id:"an-example-of-a-wdpost-machine-equipped-with-two-graphics-cards"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#an-example-of-a-wdpost-machine-equipped-with-two-graphics-cards"}},[t._v("#")]),t._v(" An example of a wdpost machine equipped with two graphics cards")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /path/to/your-damocles-worker-config.toml")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("worker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"damocles-worker-USA-01"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sector_manager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("rpc_client.addr")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/your-damocles-manager-address-here/tcp/1789"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("plan")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wdpost"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("sealing.recover_interval")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"15s"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("sealing.allowed_miners")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6666")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("plan")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wdpost"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("sealing.recover_interval")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"15s"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("sealing.allowed_miners")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7777")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("attached")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"miner-6666-store"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/miner-6666-store"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("attached")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"miner-7777-store"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/mnt/miner-7777-store"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -------------------------")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("processors. window_post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# bin="~/my_algorithm"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# args = ["window_post", ...]')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# cgroup.cpuset = "10-19"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("envs")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("concurrent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ----------- or ---------")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#[[processors. window_post]]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# bin="~/my_algorithm"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# args = ["window_post", ...]')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# cgroup.cpuset = "10-19"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# envs = { CUDA_VISIBLE_DEVICES="0", TMPDIR = "/tmp/worker-prover1/",, ... }')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# concurrent = 1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [[processors. window_post]]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# bin="~/my_algorithm"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# args = ["window_post"]')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# cgroup.cpuset = "20-29"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# envs = { CUDA_VISIBLE_DEVICES="1", TMPDIR = "/tmp/worker-prover2/", ... }')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# concurrent = 1")]),t._v("\n")])])]),s("p",[t._v("When damocles-worker is running wdpost plan, it is not necessary to use the "),s("code",[t._v("damocles-worker store sealing-init -l")]),t._v(" command to initialize the local storage directory of the data.")]),t._v(" "),s("h3",{attrs:{id:"manage-window-post-tasks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#manage-window-post-tasks"}},[t._v("#")]),t._v(" Manage window post tasks")]),t._v(" "),s("ul",[s("li",[s("h4",{attrs:{id:"show-window-post-task-list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#show-window-post-task-list"}},[t._v("#")]),t._v(" Show window post task list")])])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# By default, unfinished tasks and failed tasks are displayed, where the DDL field represents the deadline Index of the task, and the Try field is the number of attempts of the task")]),t._v("\n./damocles-manager util worker wdpost list\n\nJobID MinerID DDL Partitions Worker State Try CreateAt Elapsed Heartbeat Error\n3FgfEnvrub1 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1037")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1,2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.122")]),t._v(".63.30 ReadyToRun "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" 07-27 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":37:31 - -\ngbCVH4TUgEf "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1037")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1,2")]),t._v(" ReadyToRun "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" 07-27 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":35:56 - -\nCrotWCLaXLa "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1037")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1,2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.122")]),t._v(".63.30 Succeed "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" 07-27 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":19:04 6m38s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("done"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" -\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# show all tasks")]),t._v("\n./damocles-manager util worker wdpost list --all\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# show window post task details")]),t._v("\n./damocles-manager util worker wdpost list --detail\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#...")]),t._v("\n")])])]),s("ul",[s("li",[s("h4",{attrs:{id:"reset-task"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reset-task"}},[t._v("#")]),t._v(" reset task")])])]),t._v(" "),s("p",[t._v("When the execution of the window post task fails and the number of automatic retries reaches the limit, the task status can be manually reset so that it can continue to be picked up and executed by damocles-worker.")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("./damocles-manager util worker wdpost reset gbCVH4TUgEf 3FgfEnvrub1\n")])])]),s("ul",[s("li",[s("h4",{attrs:{id:"delete-task"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#delete-task"}},[t._v("#")]),t._v(" delete task")])])]),t._v(" "),s("p",[t._v("Deleting a task is similar to resetting a task. When the command to delete a task is executed, the retry mechanism of damocles-manager will detect whether the window post task of the current deadline exists in the database, if not, it will resend the task and record it in the database.")]),t._v(" "),s("p",[t._v("In addition, worker-prover will automatically delete tasks that have been created for more than a certain period of time (the default is 25 hours, and the time is configurable).")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Delete the specific task")]),t._v("\n./damocles-manager util worker wdpost remove gbCVH4TUgEf 3FgfEnvrub1\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# delete all tasks")]),t._v("\n./damocles-manager util worker wdpost remove-all --really-do-it\n")])])]),s("h3",{attrs:{id:"disable-damocles-manager-to-use-gpu"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#disable-damocles-manager-to-use-gpu"}},[t._v("#")]),t._v(" Disable damocles-manager to use GPU")]),t._v(" "),s("p",[t._v("After enabling the worker-prover feature, winning_post is executed by damocles-manager. If you do not want winning_post to use the GPU, you can compile damocles-manager with the following command to disable it:")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" dist-clean\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("FFI_BUILD_FROM_SOURCE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("FFI_USE_GPU")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" build-manager\n")])])]),s("h2",{attrs:{id:"proxy-node-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-node-mode"}},[t._v("#")]),t._v(" Proxy node mode")]),t._v(" "),s("p",[t._v("We know that for PoSter nodes, the most important capability is to obtain real-time and accurate sector location information. In the current "),s("code",[t._v("damocles-manager")]),t._v(" version, we only provide metadata management based on the local embedded kv database (more to be supported).")]),t._v(" "),s("p",[t._v("This only allows data to be managed by one process, and direct data sharing across processes is not possible.")]),t._v(" "),s("p",[t._v("Therefore, we designed the proxy node mode to provide some metadata to other consumer nodes through network interfaces, thus realizing data sharing.")]),t._v(" "),s("h3",{attrs:{id:"how-to-use-the-proxy-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-the-proxy-node"}},[t._v("#")]),t._v(" How to use the proxy node")]),t._v(" "),s("p",[t._v("We have added the "),s("code",[t._v("--proxy")]),t._v(" parameter to the "),s("code",[t._v("daemon run")]),t._v(" command. Its format is like "),s("code",[t._v("{ip}:{port}")]),t._v(". When the startup command contains a valid "),s("code",[t._v("--proxy")]),t._v(" parameter, "),s("code",[t._v("{ip}:{port}")]),t._v(" will be used as data source for the current "),s("code",[t._v("damocles-manager")]),t._v(" node and the necessary metadata (read-only) management module will be constructed.")]),t._v(" "),s("p",[t._v("In addition to "),s("code",[t._v("--proxy")]),t._v(", we also provide switches that control whether proxy mode is enabled for specific data management modules.")]),t._v(" "),s("p",[t._v("We just provide "),s("code",[t._v("--proxy-sector-indexer-off")]),t._v(" switch for the time being. When "),s("code",[t._v("--proxy-sector-indexer-off")]),t._v(" is enabled, nodes use the "),s("code",[t._v("SectorIndexer")]),t._v(" database in their own data directory.")]),t._v(" "),s("p",[t._v("For example, if started with the "),s("code",[t._v("damocles-manager daemon run --miner")]),t._v(" command, it will launch a "),s("code",[t._v("damocles-manager")]),t._v(" instance listening on port "),s("code",[t._v("1789")]),t._v(" using "),s("code",[t._v("~/.damocles-manager")]),t._v(" as the data directory with mining module enabled.")]),t._v(" "),s("p",[t._v("At this time, we can use the following command to initialize and start a proxy node with the above instance as the data source on the same machine. This proxy node will use "),s("code",[t._v("~/.damocles-manager2")]),t._v(" as the data directory and listen to "),s("code",[t._v("2789")]),t._v(" port.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('damocles-manager --home ~/.damocles-manager2 daemon init\n// maintain configuration files\ndamocles-manager --home ~/.damocles-manager2 daemon run --proxy="127.0.0.1:1789" --listen=":2789" --poster\n')])])]),s("p",[t._v("The proxy node can provide the exact same and real-time sector location information as the source node.")]),t._v(" "),s("h3",{attrs:{id:"the-agent-node-uses-the-existing-configuration-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#the-agent-node-uses-the-existing-configuration-file"}},[t._v("#")]),t._v(" The agent node uses the existing configuration file")]),t._v(" "),s("p",[t._v("According to the method described in the previous section, we can already start an proxy node, but there is still a problem with this startup method: the configuration file of the proxy node needs to be written again, or copied from the data directory of the source node. This introduces additional maintenance work, especially when configuration files may change frequently.")]),t._v(" "),s("p",[t._v("For this, we also provide a "),s("code",[t._v("--conf-dir")]),t._v(" parameter, which is in the form of a directory path. When the startup command includes a valid "),s("code",[t._v("--conf-dir")]),t._v(" parameter, the node will use the configuration file that already exists in the specified directory as its own configuration file.")]),t._v(" "),s("p",[t._v("This saves the work of writing and maintaining configuration files for different source and agent nodes on the same machine and serving the same set of clusters.")]),t._v(" "),s("p",[t._v("Based on this function, the agent node startup method mentioned in the previous section can become:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('damocles-manager --home ~/.damocles-manager2 daemon run --proxy="127.0.0.1:1789" --listen=":2789" --conf-dir="~/.damocles-manager" --poster\n')])])]),s("p",[t._v("At this point, the source node and the proxy node will use the same batch of configuration files.")]),t._v(" "),s("h2",{attrs:{id:"ext-prover-executor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ext-prover-executor"}},[t._v("#")]),t._v(" ext-prover executor")]),t._v(" "),s("p",[t._v("In addition to sharing sector information, another challenge faced by standalone PoSter nodes is the utilization of hardware resources.")]),t._v(" "),s("p",[t._v("Limited by the underlying algorithm library, granularity of computing nodes utilizing GPUs is by process. This makes it difficult for PoSter nodes to effectively utilize the computing power of multiple GPUs, and it is also difficult to safely avoid proof timeouts when multiple "),s("code",[t._v("SP")]),t._v("s have conflicting "),s("code",[t._v("WindostPoSt")]),t._v(" proof windows.")]),t._v(" "),s("p",[t._v("For this, we provide an "),s("code",[t._v("ext-prover")]),t._v(" mechanism similar to the "),s("code",[t._v("ext processor")]),t._v(" in "),s("code",[t._v("damocles-worker")]),t._v(".")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("ext-prover")]),t._v(" mechanism consists of two components:")]),t._v(" "),s("ol",[s("li",[t._v("The "),s("code",[t._v("--ext-prover")]),t._v(" parameter of the "),s("code",[t._v("daemon run")]),t._v(" command")]),t._v(" "),s("li",[t._v("The "),s("code",[t._v("ext-prover.cfg")]),t._v(" configuration file in the node data directory")])]),t._v(" "),s("p",[t._v("A default "),s("code",[t._v("ext-prover.cfg")]),t._v(" file looks like:")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default config:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#[[WdPost]]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#Bin = "/path/to/custom/bin"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#Args = ["args1", "args2", "args3"]')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#Concurrent = 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#Weight = 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#ReadyTimeoutSecs = 5")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#[WdPost.Envs]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#ENV_KEY = "ENV_VAL"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#[[WinPost]]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#Bin = "/path/to/custom/bin"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#Args = ["args1", "args2", "args3"]')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#Concurrent = 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#Weight = 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#ReadyTimeoutSecs = 5")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#[WinPost.Envs]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#ENV_KEY = "ENV_VAL"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n")])])]),s("p",[t._v("In recent versions, "),s("code",[t._v("daemon init")]),t._v(" initializes the "),s("code",[t._v("ext-prover.cfg")]),t._v(" file.")]),t._v(" "),s("p",[t._v("Users can write their own, or copy the corresponding files from a data directory initialized by the latest version to an existing data directory.")]),t._v(" "),s("p",[t._v("The functions of the configuration items in "),s("code",[t._v("ext-prover.cfg")]),t._v(" are very similar to the configuration blocks in "),s("code",[t._v("damocles-worker")]),t._v(", and users can refer to the corresponding documents for reference.")]),t._v(" "),s("p",[t._v("When the "),s("code",[t._v("--ext-prover")]),t._v(" parameter is included in the start command of "),s("code",[t._v("damocles-manager")]),t._v(", the node will use the "),s("code",[t._v("ext-prover.cfg")]),t._v(" configuration file in the configuration directory as the basis for starting child processes. For this configuration file, setting the "),s("code",[t._v("--conf-dir")]),t._v(" parameter will also have an effect.")]),t._v(" "),s("p",[t._v("If user sees logs like the following, then it means that "),s("code",[t._v("ext-prover")]),t._v(" is ready.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('2022-04-27T19:15:00.441+0800 INFO porver-ext ext/prover.go:122 response loop start {"pid": 24764, "ppid": 24732, "loop": "resp"}\n2022-04-27T19:15:00.441+0800 INFO porver-ext ext/prover.go:155 request loop start {"pid": 24764, "ppid": 24732, "loop": "req"}\n2022-04-27T19:15:00.468+0800 INFO processor-cmd processor/processor.go:35 ready {"pid": 24764, "ppid": 24732, "proc": "wdpost"}\n')])])]),s("h2",{attrs:{id:"deployment-practice"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deployment-practice"}},[t._v("#")]),t._v(" Deployment Practice")]),t._v(" "),s("p",[t._v("Suppose we have a node machine with 8 GPUs, then we can provide stronger PoSt processing capabilities through the following configuration.")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Configure and start the source node")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("damocles-manager daemon run --miner\n")])])]),s("p",[t._v("At this time, the source node only provides functions and capabilities related to sealing;")])]),t._v(" "),s("li",[s("p",[t._v("Configure the "),s("code",[t._v("ext-prover.cfg")]),t._v(" file:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('[[WdPost]]\n[WdPost.Envs]\nCUDA_VISIBLE_DEVICES = "0"\nTMPDIR = "/tmp/ext-prover0/"\n\n[[WdPost]]\n[WdPost.Envs]\nCUDA_VISIBLE_DEVICES = "1"\nTMPDIR = "/tmp/ext-prover1/"\n\n[[WdPost]]\n[WdPost.Envs]\nCUDA_VISIBLE_DEVICES = "2"\nTMPDIR = "/tmp/ext-prover2/"\n\n[[WdPost]]\n[WdPost.Envs]\nCUDA_VISIBLE_DEVICES = "3"\nTMPDIR = "/tmp/ext-prover3/"\n\n[[WdPost]]\n[WdPost.Envs]\nCUDA_VISIBLE_DEVICES = "4"\nTMPDIR = "/tmp/ext-prover4/"\n\n[[WdPost]]\n[WdPost.Envs]\nCUDA_VISIBLE_DEVICES = "5"\nTMPDIR = "/tmp/ext-prover5/"\n\n[[WdPost]]\n[WdPost.Envs]\nCUDA_VISIBLE_DEVICES = "6"\nTMPDIR = "/tmp/ext-prover6/"\n\n[[WdPost]]\n[WdPost.Envs]\nCUDA_VISIBLE_DEVICES = "7"\nTMPDIR = "/tmp/ext-prover7/"\n\n')])])])]),t._v(" "),s("li",[s("p",[t._v("Initialize and start a standalone "),s("code",[t._v("PoSter")]),t._v(" node")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('damocles-manager --home=~/.damocles-individual-poster daemon init\ndamocles-manager --home=~/.damocles-individual-poster daemon run --proxy="127.0.0.1:1789" --poster --listen=":2789" --conf-dir="~/.damocles-manager" --ext-prover\n')])])])])]),t._v(" "),s("p",[t._v("By this way of deployment,")]),t._v(" "),s("ul",[s("li",[t._v("The source node provides both sealing and mining support")]),t._v(" "),s("li",[t._v("Proxy nodes provide "),s("code",[t._v("WindowPoSt")]),t._v(" support\n"),s("ul",[s("li",[t._v("The proxy node enables "),s("code",[t._v("ext-prover")]),t._v(", and each child process independently uses a GPU and a computing lock directory")])])])]),t._v(" "),s("p",[t._v("There is no conflict between "),s("code",[t._v("winningPost")]),t._v(" and "),s("code",[t._v("windowPost")]),t._v(" due to device usage")]),t._v(" "),s("h2",{attrs:{id:"limitations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#limitations"}},[t._v("#")]),t._v(" Limitations")]),t._v(" "),s("p",[t._v("So far, we have described the functions, principles and simple usage examples that stand-alone "),s("code",[t._v("PoSter")]),t._v(" nodes rely on.")]),t._v(" "),s("p",[t._v("However, this mode still has some limitations for very large "),s("code",[t._v("SP")]),t._v(" clusters, which may manifest in:")]),t._v(" "),s("ul",[s("li",[t._v("The scheduling of the "),s("code",[t._v("PoSt")]),t._v(" and the serious conflict in the "),s("code",[t._v("PoSt")]),t._v(" window period still relies on the operation and maintenance to a certain extent;")])])])}),[],!1,null,null,null);e.default=n.exports}}]);