(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{431:function(a,t,s){"use strict";s.r(t);var n=s(17),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"snapdeal-的支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#snapdeal-的支持"}},[a._v("#")]),a._v(" SnapDeal 的支持")]),a._v(" "),s("h2",{attrs:{id:"snapdeal-简述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#snapdeal-简述"}},[a._v("#")]),a._v(" SnapDeal 简述")]),a._v(" "),s("p",[s("code",[a._v("SnalDeal")]),a._v(" 是在 "),s("a",{attrs:{href:"https://github.com/filecoin-project/FIPs/blob/master/FIPS/fip-0019.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("FIP-19"),s("OutboundLink")],1),a._v(" 中提出，在 "),s("code",[a._v("network15")]),a._v(" 上线的一种扇区升级方案。\n相比之前的升级方案需要重新、完整完成一遍封装过程的巨大开销，"),s("code",[a._v("SnalDeal")]),a._v(" 显得相当轻量，它的开销大约为：")]),a._v(" "),s("ul",[s("li",[a._v("完成一次 "),s("code",[a._v("add piece")])]),a._v(" "),s("li",[a._v("完成一次 "),s("code",[a._v("tree d")])]),a._v(" "),s("li",[a._v("完成一次 "),s("code",[a._v("snap_encode")]),a._v("，其开销约等于一次 "),s("code",[a._v("pc2")])]),a._v(" "),s("li",[a._v("完成一次 "),s("code",[a._v("snap_prove")]),a._v("，其开销约等于一次 "),s("code",[a._v("c1")]),a._v(" + "),s("code",[a._v("c2")]),a._v("\n因此，无论是对于新增的真实数据存储需求，还是对存量 "),s("code",[a._v("CC 扇区")]),a._v(" 进行转化，"),s("code",[a._v("SnalDeal")]),a._v(" 都具备相当的吸引力。")])]),a._v(" "),s("h2",{attrs:{id:"damocles-对-snapdeal-的支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#damocles-对-snapdeal-的支持"}},[a._v("#")]),a._v(" damocles 对 SnapDeal 的支持")]),a._v(" "),s("p",[s("code",[a._v("damocles")]),a._v(" 在设计之初就着眼于提供生产线模式的算力生产方案，为此我们提供了一种不太需要人工介入的 "),s("code",[a._v("SnapDeal")]),a._v(" 生产方案，我们称之为 "),s("code",[a._v("SnapUp")]),a._v("。它的步骤大致如下：")]),a._v(" "),s("ol",[s("li",[a._v("将已有的 "),s("code",[a._v("CC 扇区")]),a._v(" 批量导入为本地候选扇区")]),a._v(" "),s("li",[a._v("配置 "),s("code",[a._v("damocles-manager")]),a._v("，对指定 "),s("code",[a._v("SP")]),a._v(" 启用 "),s("code",[a._v("SnapUp")]),a._v(" 支持")]),a._v(" "),s("li",[a._v("配置 "),s("code",[a._v("damocles-worker")]),a._v("，将已有的 "),s("code",[a._v("sealing_thread")]),a._v(" 转化成 "),s("code",[a._v("SnapUp")]),a._v(" 生产计划，或新增用于 "),s("code",[a._v("SnapUp")]),a._v(" 的 "),s("code",[a._v("sealing_thread")]),a._v("\n整个过程中，使用者仅需关注本地候选扇区的导入和余量，其余过程都会自动完成。")])]),a._v(" "),s("h2",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[a._v("#")]),a._v(" 示例")]),a._v(" "),s("p",[a._v("下面以一套 "),s("code",[a._v("butterfly")]),a._v(" 网络上的生产集群为例，逐步演示如何配置 "),s("code",[a._v("SnapUp")]),a._v(" 的生产方案。")]),a._v(" "),s("h3",{attrs:{id:"候选扇区的导入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#候选扇区的导入"}},[a._v("#")]),a._v(" 候选扇区的导入")]),a._v(" "),s("p",[a._v("使用新增的 "),s("code",[a._v("util sealer snap fetch")]),a._v(" 工具，能够按 "),s("code",[a._v("deadline")]),a._v(" 将满足限制（剩余生命周期大于 180 天，满足订单的最小生命周期）的 "),s("code",[a._v("CC 扇区")]),a._v(" 导入为本地候选扇区。")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('./dist/bin/damocles-manager util sealer snap fetch 1153 3\n2022-04-15T04:28:03.380Z        DEBUG   policy  policy/const.go:18      NETWORK SETUP   {"name": "butterfly"}\n2022-04-15T04:28:03.401Z        INFO    cmd     internal/util_sealer_snap.go:53 candidate sectors fetched        {"available-in-deadline": 2, "added": 2}\n')])])]),s("h3",{attrs:{id:"观察候选扇区的余量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#观察候选扇区的余量"}},[a._v("#")]),a._v(" 观察候选扇区的余量")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('./dist/bin/damocles-manager util sealer snap candidates 1153\n2022-04-15T04:28:13.955Z        DEBUG   policy  policy/const.go:18      NETWORK SETUP   {"name": "butterfly"}\ndeadline  count\n3         2\n')])])]),s("p",[a._v("可以看到，当前存在 2 个 "),s("code",[a._v("#3 deadline")]),a._v(" 中的 "),s("code",[a._v("CC 扇区")]),a._v(" 作为候选，可供升级")]),a._v(" "),s("h3",{attrs:{id:"配置-damocles-worker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-damocles-worker"}},[a._v("#")]),a._v(" 配置 "),s("code",[a._v("damocles-worker")])]),a._v(" "),s("p",[s("code",[a._v("damocles-worker")]),a._v(" 中需要配置的内容主要是用于 "),s("code",[a._v("SnapUp")]),a._v(" 任务的 "),s("code",[a._v("sealing_thread")]),a._v("，和针对 "),s("code",[a._v("snap_encode")]),a._v("、"),s("code",[a._v("snap_prove")]),a._v(" 的计算资源分配。")]),a._v(" "),s("p",[a._v("示例如下：")]),a._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/local-snap-1"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("plan")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"snapup"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/local-snap-2"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("plan")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"snapup"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/local-snap-3"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("plan")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"snapup"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/local-snap-4"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("plan")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"snapup"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/local-snap-5"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("plan")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"snapup"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/local-snap-6"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("plan")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"snapup"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("sealing_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/local-snap-6"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("plan")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"snapup"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("processors.limitation.concurrent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ...")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("tree_d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("snap_encode")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("snap_prove")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("processors.snap_encode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("envs")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("FIL_PROOFS_USE_GPU_COLUMN_BUILDER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("FIL_PROOFS_USE_GPU_TREE_BUILDER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("CUDA_VISIBLE_DEVICES")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("TMPDIR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/var/tmp/worker0"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("processors.snap_prove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("envs")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("CUDA_VISIBLE_DEVICES")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("TMPDIR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/var/tmp/worker0"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("processors.snap_encode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("envs")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("FIL_PROOFS_USE_GPU_COLUMN_BUILDER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("FIL_PROOFS_USE_GPU_TREE_BUILDER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("CUDA_VISIBLE_DEVICES")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("TMPDIR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/var/tmp/worker1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[a._v("processors.snap_prove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("envs")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("CUDA_VISIBLE_DEVICES")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("TMPDIR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/var/tmp/worker1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[s("code",[a._v("snap_encode")]),a._v(" 的计算资源分配可以参考 "),s("code",[a._v("pc2")]),a._v("，"),s("code",[a._v("snap_prove")]),a._v(" 的计算资源分配可以参考 "),s("code",[a._v("c2")])]),a._v(" "),s("h3",{attrs:{id:"配置-damocles-manager"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-damocles-manager"}},[a._v("#")]),a._v(" 配置 "),s("code",[a._v("damocles-manager")])]),a._v(" "),s("p",[s("code",[a._v("damocles-manager")]),a._v(" 中需要的配置内容主要是为指定的 "),s("code",[a._v("SP")]),a._v(" 启用 "),s("code",[a._v("SnapUp")]),a._v("，示例如下：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('[[Miners]]\nActor = 1153\n[Miners.Sector]\nInitNumber = 0\nMaxNumber = 10000\nEnabled = true\nEnableDeals = false\n\n[Miners.SnapUp]\nEnabled = true\nSender = "t1abjxfbp274xpdqcpuaykwkfb43omjotacm2p3za"\n')])])]),s("p",[a._v("其中")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("[Miners.Sector]")]),a._v(" 块中的配置内容不会影响 "),s("code",[a._v("SnapUp")]),a._v(" 的运转。")]),a._v(" "),s("li",[a._v("在这套配置下，将可以支持：\n"),s("ul",[s("li",[s("code",[a._v("CC 扇区")]),a._v(" 持续生产")]),a._v(" "),s("li",[s("code",[a._v("SnapUp")]),a._v(" 在本地候选扇区有余量的情况下持续生产")])])])]),a._v(" "),s("h3",{attrs:{id:"注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[a._v("#")]),a._v(" 注意事项：")]),a._v(" "),s("ol",[s("li",[a._v("考虑到 "),s("code",[a._v("snap_encode")]),a._v(" 和 "),s("code",[a._v("snap_prove")]),a._v(" 所需的计算资源，如果在同一个 "),s("code",[a._v("damocles-worker")]),a._v(" 实例中同时启用常规扇区封装和 "),s("code",[a._v("SnapUp")]),a._v(" 的话，可能需要考虑资源竞争的情况，可以参考 "),s("RouterLink",{attrs:{to:"/zh/operation/processors-config-example.html"}},[a._v("07.damocles-worker 外部执行器的配置范例")])],1),a._v(" "),s("li",[a._v("考虑到扇区持久化数据的分布情况，用于 "),s("code",[a._v("SnapUp")]),a._v(" 的 "),s("code",[a._v("damocles-worker")]),a._v(" 需要同时能够以可读可写的方式访问所有持久化存储空间 ("),s("code",[a._v("persist store")]),a._v(")，且确保他们的命名和 "),s("code",[a._v("damocles-manager")]),a._v(" 中一致。")]),a._v(" "),s("li",[a._v("基于以上两点，我们推荐使用单独的设备专门进行 "),s("code",[a._v("SnapUp")]),a._v(" 的生产，从而避免常规扇区和 "),s("code",[a._v("SnapUp")]),a._v(" 混布带来的配置和运维的复杂度。")])]),a._v(" "),s("h2",{attrs:{id:"持续优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#持续优化"}},[a._v("#")]),a._v(" 持续优化")]),a._v(" "),s("p",[a._v("对于 "),s("code",[a._v("SnapUp")]),a._v(" 方案的完善和优化还在不断进行中，目前我们主要关注：")]),a._v(" "),s("ul",[s("li",[a._v("将半自动的候选扇区导入转换成自动方式，或提供等效的运维工具")]),a._v(" "),s("li",[a._v("更多候选扇区导入规则，如按存储配置导入")]),a._v(" "),s("li",[a._v("上链消息的聚合，以降低成本")]),a._v(" "),s("li",[a._v("其他能够简化运维、降低成本、提高效率的优化和工具")])])])}),[],!1,null,null,null);t.default=e.exports}}]);