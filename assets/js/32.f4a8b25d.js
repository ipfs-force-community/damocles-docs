(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{400:function(e,a,s){"use strict";s.r(a);var t=s(17),r=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"快速启用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速启用"}},[e._v("#")]),e._v(" 快速启用")]),e._v(" "),s("h2",{attrs:{id:"准备工作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[e._v("#")]),e._v(" 准备工作")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("安装必要的第三方库。")]),e._v(" "),s("p",[e._v("这一部分可以参考 "),s("code",[e._v("lotus")]),e._v(" 文档中的相应部分 "),s("a",{attrs:{href:"https://lotus.filecoin.io/lotus/install/linux/#software-dependencies",target:"_blank",rel:"noopener noreferrer"}},[e._v("Software dependencies"),s("OutboundLink")],1),e._v("。")])]),e._v(" "),s("li",[s("p",[e._v("下载代码库")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("git clone https://github.com/ipfs-force-community/damocles.git\n")])])])]),e._v(" "),s("li",[s("p",[e._v("编译 "),s("code",[e._v("damocles")]),e._v(" 的组件")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cd damocles\nmake all\n")])])]),s("p",[e._v("完成后，在 "),s("code",[e._v("./dist/bin")]),e._v(" 目录下会有 "),s("code",[e._v("damocles-worker")]),e._v(" 和 "),s("code",[e._v("damocles-manager")]),e._v(" 两个可执行文件。")])]),e._v(" "),s("li",[s("p",[e._v("分发可执行文件到需要的机器上。")])]),e._v(" "),s("li",[s("p",[e._v("将 "),s("code",[e._v("./damocles-worker/create-cgroup.sh")]),e._v(" 分发到 "),s("code",[e._v("damocles-worker")]),e._v(" 所在的机器上，并以准备运行 "),s("code",[e._v("damocles-worker")]),e._v(" 的系统用户身份执行。")]),e._v(" "),s("p",[e._v("这会为这样的用户生成相应的 "),s("code",[e._v("cgroup")]),e._v(" 组，以便"),s("code",[e._v("damocles-worker")]),e._v(" 为其外部执行器进程分配硬件资源。")])])]),e._v(" "),s("h2",{attrs:{id:"mock-模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mock-模式"}},[e._v("#")]),e._v(" Mock 模式")]),e._v(" "),s("p",[e._v("默认情况下，可以通过一系列命令在单机上启动一组 "),s("code",[e._v("mock")]),e._v(" 实例。")]),e._v(" "),s("h3",{attrs:{id:"damocles-manager"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#damocles-manager"}},[e._v("#")]),e._v(" damocles-manager")]),e._v(" "),s("p",[e._v("通过")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("./dist/bin/damocles-manager mock --miner=10000 --sector-size=2KiB\n")])])]),s("p",[e._v("命令启动一个模拟为 Actor 为 "),s("code",[e._v("t010000")]),e._v("   的 "),s("code",[e._v("SP")]),e._v(" 分配 2KiB 扇区的 "),s("code",[e._v("damocles-manager")]),e._v(" 服务。")]),e._v(" "),s("p",[e._v("这一步骤也可以通过代码目录中的 "),s("code",[e._v("./mock/start_smgr.sh")]),e._v(" 脚本完成。")]),e._v(" "),s("h3",{attrs:{id:"damocles-worker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#damocles-worker"}},[e._v("#")]),e._v(" damocles-worker")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("创建并初始化本地存储，初始化远程存储")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("./dist/bin/damocles-worker store sealing-init -l ./mock-tmp/store1 ./mock-tmp/store2 ./mock-tmp/store3\n./dist/bin/damocles-worker store file-init -l ./mock-tmp/remote\n")])])]),s("p",[e._v("这一步骤也可以通过代码目录中的 "),s("code",[e._v("./mock/cleanup_store.sh")]),e._v(" 脚本完成。")])]),e._v(" "),s("li",[s("p",[e._v("以 "),s("code",[e._v("mock")]),e._v(" 配置启动 "),s("code",[e._v("damocles-worker")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("./dist/bin/damocles-worker daemon -c ./damocles-worker/assets/damocles-worker.mock.toml\n")])])]),s("p",[e._v("这一步骤也可以通过代码目录中的 "),s("code",[e._v("./mock/start_worker.sh")]),e._v(" 脚本完成。")])])]),e._v(" "),s("h2",{attrs:{id:"生产模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生产模式"}},[e._v("#")]),e._v(" 生产模式")]),e._v(" "),s("h3",{attrs:{id:"damocles-manager-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#damocles-manager-2"}},[e._v("#")]),e._v(" damocles-manager")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("初始化工作目录")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("./dist/bin/damocles-manager daemon init\n")])])])]),e._v(" "),s("li",[s("p",[e._v("按需配置默认配置文件 "),s("code",[e._v("~/.damocles-manager/sector-manager.cfg")])]),e._v(" "),s("p",[e._v("配置项、作用、配置方法可以参考文档 "),s("RouterLink",{attrs:{to:"/zh/operation/04.venus-sector-manager的配置解析.html"}},[s("code",[e._v("04.venus-sector-manager的配置解析")])]),e._v("。")],1)]),e._v(" "),s("li",[s("p",[e._v("创建矿工号")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("$ ./damocles-manager util miner create \\\n--from=<OWNER_ADDRESS> \\\n--owner=<OWNER_ADDRESS> \\\n--worker=<WORKER_ADDRESS> \\\n--sector-size=32GiB\n")])])]),s("p",[e._v("如果已有，可略过此步骤。")])]),e._v(" "),s("li",[s("p",[e._v("启动 "),s("code",[e._v("damocles-manager")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("./dist/bin/damocles-manager daemon run\n")])])])])]),e._v(" "),s("h3",{attrs:{id:"venus-worker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#venus-worker"}},[e._v("#")]),e._v(" venus-worker")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("规划用于封装过程中数据的本地存储，并使用")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("./dist/bin/damocles-worker store sealing-init -l <dir1> <dir2> <dir3> <...>\n")])])]),s("p",[e._v("命令创建并初始化数据目录。")])]),e._v(" "),s("li",[s("p",[e._v("挂载持久化数据目录，并使用")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("./dist/bin/damocles-worker store file-init -l <dir1>\n")])])]),s("p",[e._v("命令初始化数据目录。")])]),e._v(" "),s("li",[s("p",[e._v("(可选) "),s("RouterLink",{attrs:{to:"/zh/operation/15.venus-worker_PC1_HugeTLB_Pages_支持.html#venus-worker-pc1-hugetlb-pages-支持"}},[e._v("创建 NUMA 亲和的 hugepage 内存文件")])],1)]),e._v(" "),s("li",[s("p",[e._v("规划用于各阶段的 CPU 核、numa 区域等配置。")]),e._v(" "),s("p",[e._v("按需完成配置文件。")]),e._v(" "),s("p",[e._v("配置项、作用、配置方法可以参考文档 "),s("RouterLink",{attrs:{to:"/zh/operation/03.venus-worker的配置解析.html"}},[s("code",[e._v("03.venus-worker的配置解析")])]),e._v("。")],1)]),e._v(" "),s("li",[s("p",[e._v("使用")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("/path/to/damocles-worker daemon -c /path/to/damocles-worker.toml\n")])])]),s("p",[e._v("启动 "),s("code",[e._v("damocles-worker")]),e._v("。")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);